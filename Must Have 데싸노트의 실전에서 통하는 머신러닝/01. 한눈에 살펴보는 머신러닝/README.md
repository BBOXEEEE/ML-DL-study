# 01. 한눈에 살펴보는 머신러닝

### 머신러닝 기법 : 지도 학습, 비지도 학습, 강화 학습

머신러닝에는 지도 학습, 비지도 학습, 강화 학습이라는 3가지 범주가 있다.

**지도 학습** 은 입력값, 정답을 사용해 관계를 분석하고 예측 모델을 만들어낸다. 지도 학습은 목적에 따라 **회귀 문제** 와 **분류 문제** 로 구분할 수 있다. **회귀 문제** 는 예측 결과값이 연속성을 지니는 경우, **분류 문제** 는 예측 결과값이 비연속적인 경우이다.

- **회귀** : 연속된 값을 측정하는 문제, 실수형으로 결과를 표현하며 가격 예측과 같은 것이 해당된다.
- **분류** : 범주형 값을 측정하는 문제, 예/아니오와 같은 두 가지 범주로 표현되는 것이 해당된다.

**비지도 학습** 은 정답이 없는 데이터만으로 학습한다.

 - **군집화** : 비슷한 데이터끼리 묶는 비지도 학습 방법이다.
 - **변환** : 목적에 따라 데이터를 다른 형태로 변환하는 방법이다.
 - **연관** : 장바구니 분석이라고도 하며, 유사한 구매 목록을 가진 고객끼리 비교하여 새로운 아이템을 추천하는 목적 등으로 사용할 수 있다.

**강화 학습** 은 행동에 대한 보상과 처벌을 기반으로 하는 학습 방법이다. 보상은 행동을 유도하고, 처벌은 행동을 피하게끔 한다.

### 머신러닝 프로세스

머신러닝의 전체 과정은 `데이터 수집 -> 데이터 전처리 -> 모델 학습 -> 모델 평가 -> 모델 배포` 의 순서로 이루어진다.
```Text
1. 데이터 수집
머신러닝에 활용할 데이터를 수집하는 단계이다.

2. 데이터 전처리
잘못된 값이나 활용하기 불편한 데이터를 수정 및 정리하며, 기존 데이터를 활용해 추가적인 데이터를 만들어내는 과정이다. 피처 엔지니어링도 전처리의 한 과정이다.

3. 모델 학습
준비된 데이터를 머신러닝 알고리즘에 반영해 학습시키는 과정이다.
하이퍼파라미터를 조정해 모델의 성능을 극대화시키는 과정도 포함된다.

4. 모델 평가
학습된 모델을 사용해 예측하고 결과를 평가하는 단계이다.

5. 모델 배포
머신러닝 결과물을 활용하는 단계이다.
```


### 데이터 시각화 그래프 종류

이 책에서 대부분 `seaborn` 라이브러리를 사용해 그래프를 그리고, 크기나 폰트 등을 변경하는데 `맷플롯립` 라이브러리를 사용한다.

데이터 시각화 그래프 종류는 다음과 같다.
- **선형 그래프** : 연속도니 변수에 대한 특정 값의 변화를 나타내는데 적합한 그래프
- **산점도** : 두 변수 간의 전체적인 관계 및 그에 대한 분포를 표현하는 그래프
- **히스토그램** : 도수분포표를 나타내는 그래프
- **박스 플롯** : 데이터의 대략적인 분포 (25%, 50%, 75% 지점)와 이상치 등을 간결하게 보여주는 그래프
- **히트맵** : 데이터를 색상으로 표현하는 그래프, 다른 그래프들과 달리 여러 변수를 동시에 반영할 수 있다.
- **막대 그래프** : 히스토그램과 달리 특정 구간이 아닌 특정 범주에 대한 그래프를 그리는 그래프

아래 코드를 통해 실습할 수 있다.
```python
# 예제 데이터 로딩
import seaborn as sns
data = sns.load_dataset('tips')

# 선형 그래프
sns.lineplot(x = 'size', y = 'total_bill', data = data, hue = 'sex')

# 산점도
sns.scatterplot(x = 'tip', y = 'total_bill', data = data, hue = 'sex')

# 히스토그램
sns.histplot(data['size'])

# 박스 플롯
sns.boxplot(x = 'day', y = 'total_bill', data = data)

# 히트맵
sns.heatmap(data.corr())

# 막대 그래프
sns.barplot(x = 'day', y = 'total_bill', data = data)
```

### 피처 엔지니어링 기법

**피처 엔지니어링 기법** 은 입력 데이터를 풍성하고 가치 있게 만드는 작업이다. 데이터가 좋을수록 더 좋은 결과를 얻을 수 있기 때문에 머신러닝 프로세스 중 가장 중요한 과정이라고 해도 무리가 없으며, 시간과 노력을 들여야한다. 피처 엔지니어링 기법은 다음과 같다.

- **결측치 처리** : 데이터가 누락된 부분을 평균, 특정값 등으로 채우는 기법
- **아웃라이어 처리** : 다른 데이터 무리들과 크게 벗어나는 아웃라이어를 제거하거나 값을 조정해 튀는 데이터가 없도록 하는 기법
- **바이닝** : 연속된 수치로 된 데이터를 특정 구간으로 묶는 기법 (ex. 10대, 20대 등)
- **로그 변환** : 데이터에 로그를 씌워 왜곡된 데이터를 정규화하는 기법
- **더미 변수 (One-Hot-Encoding)** : 문자로 된 범주형 데이터를 0과 1을 사용하는 숫자형 데이터로 변경하는 기법
- **그룹핑** : 고유값이 너무 많은 범주형 데이터를 특정 그룹으로 묶는 기법
- **스케일링** : 각 변수의 데이터 범위가 다를 때, 이를 일정하게 맞춰주는 기법
- **날짜 추출** : 날짜 데이터에서 연/월/일 혹은 요일 등을 추출해 필요한 정보만 사용하는 기법
- **텍스트 분할** : 텍스트로 된 변수에서 특정 부분의 단어를 빼오거나, 특정 기호가 들어간 부분을 기준으로 나누어 필요한 항목만 추출하는 기법
- **새로운 변수 창출** : 주어진 변수들을 사용해 새로운 변수를 계산해내는 기법

## 요약
- **머신러닝** 은 지도 학습, 비지도 학습, 강화 학습으로 나눌 수 있다.
- **머신러닝 프로세스** 는 데이터 수집 -> 데이터 전처리 -> 모델 학습 -> 모델 평가 -> 모델 활용 등으로 이루어진다.
- **피처 엔지니어링** 은 모델 학습에 입력할 데이터를 더 풍성하고 가치 있게 만드는 작업이다.
- **독립변수** 는 예측에 사용되는 재료와 같은 변수들이다. 피처 변수 혹은 피처라고도 부른다.
- **종속변수** 는 에측을 하려는 대상 변수이며, 목표 변수라고도 한다. 타깃이라고도 부른다.

